<% layout('layout') -%>
<link rel="stylesheet" href="/css/styleHomepage.css" type="text/css" />

<!-- <h3 style="padding-left: 20px; margin-top:20px;">My Google Maps Demo</h3> -->
    <div id="floating-panel">
      <input id="addmarker" onclick="addmarker();"  type=button value="Add Markers">
      <input id="stopadd" onclick="stopAdd();" type=button value="Stop Add Markers">
      <input onclick="configMarkers();" type=button value="Config Markers">
    </div>
    <div id="map"></div>

    <script>
    var map;
    var markers = []; 
      function initMap() {
        var markers = [];
        var myLatLng = [{lat: 10.773283, lng: 106.667639},
                        {lat: 10.763268, lng: 106.677639},
                        {lat: 10.753883, lng: 106.687639},
                        {lat: 10.783183, lng: 106.647639}]

        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 13,
          center: myLatLng[0]
        });

        // Create markers

        for(var i=0;i<4;i++){
          var marker = new google.maps.Marker({
          position: myLatLng[i],
          map: map,
          
          });
          markers.push(marker);
        }

        // Circle overlay

        for(var i=0;i<4;i++){
          var circle = new google.maps.Circle({
            map: map,
            radius: 1200,    // 10 miles in metres
            fillColor: '#AA0000'
          });
          circle.bindTo('center', markers[i], 'position');
        }

        
      }

      function addMarker(location) {    
        var marker = new google.maps.Marker({    
          position: location,    
          map: map

        });
        var temp = markers.length;

        markers.push(marker); 
        if(temp==0){
          for(var i=0;i<markers.length;i++){
            var circle = new google.maps.Circle({
              map: map,
              radius: 1200,    // 10 miles in metres
              fillColor: '#AA0000'
            });
            circle.bindTo('center', markers[i], 'position');
          }
        }else{
          for(var i=temp;i<markers.length;i++){
            var circle = new google.maps.Circle({
              map: map,
              radius: 1200,    // 10 miles in metres
              fillColor: '#AA0000'
            });
            circle.bindTo('center', markers[i], 'position');
          }
        }

  

      }

      function addmarker(){
        document.getElementById("addmarker").style.color = "blue";
    
        map.addListener('click', function(event) {    
        
       
        var lat = event.latLng.lat();
        var len = event.latLng.lng();
        addMarker(event.latLng);
        // alert(event.latLng.lat());
        });  

      }
      // Stop add markers
      function stopAdd(){
        document.getElementById("addmarker").style.color = "black";
        google.maps.event.clearListeners(map, 'click');
      }

      function configMarkers(){
        window.location.href = "test.php";
      }

      function configMarkers(){
        window.location.href = "/configmarkers";
      }
    </script>

    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCp5FCefvQbDVIoiuvnlEBRXm7jjEHUKSM&callback=initMap">
    </script>
    